<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>观山悦水晶 - 费用计算器</title>
    <style>
        :root {
            --primary-deep: #4a148c;   /* 深紫 */
            --primary-mid: #7b1fa2;    /* 中紫 */
            --primary-light: #e1bee7;  /* 浅紫 */
            --accent-gold: #ffd700;    /* 金色高亮 */
            --text-dark: #333;
            --white-glass: rgba(255, 255, 255, 0.92);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f3e5f5 0%, #ce93d8 50%, #8e24aa 100%);
            color: var(--text-dark);
            min-height: 100vh;
            padding-bottom: 40px;
        }

        /* 导航栏 */
        .navbar {
            background-color: var(--primary-deep);
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            padding: 15px 10px;
            font-size: 16px;
            font-weight: 500;
            flex: 1;
            text-align: center;
            transition: all 0.3s;
        }

        .navbar a.active {
            background-color: var(--primary-mid);
            border-bottom: 4px solid var(--accent-gold);
            font-weight: bold;
        }

        .container {
            max-width: 600px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* 卡片通用样式 */
        .card {
            background: var(--white-glass);
            border-radius: 16px;
            padding: 25px 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .card h2 {
            margin-top: 0;
            color: var(--primary-mid);
            font-size: 1.25rem;
            border-bottom: 2px solid var(--primary-light);
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .card h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 24px;
            background-color: var(--primary-mid);
            margin-right: 10px;
            border-radius: 4px;
        }

        /* 表单控件 */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            font-size: 0.95rem;
            color: #555;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s;
            background-color: #fafafa;
        }

        input[type="number"]:focus {
            border-color: var(--primary-mid);
            outline: none;
            background-color: #fff;
        }

        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(to right, var(--primary-mid), var(--primary-deep));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.3);
            transition: transform 0.2s;
        }

        button:active {
            transform: scale(0.98);
        }

        /* 结果区域 */
        .result-box {
            display: none;
            margin-top: 25px;
            background-color: #f8f0fa;
            border-radius: 12px;
            padding: 15px;
            border-left: 5px solid var(--primary-mid);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px dashed #d1c4e9;
            font-size: 0.95rem;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        /* 高亮样式 */
        .highlight {
            background-color: rgba(255, 215, 0, 0.2); /* 金色背景淡化 */
            border-radius: 6px;
            padding: 10px 5px;
            margin: 5px -5px;
            font-weight: bold;
        }
        
        .highlight span:last-child {
            color: #d81b60; /* 醒目的玫红色数值 */
            font-size: 1.1em;
        }

        /* 底部提示语 */
        .notice-text {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8eaf6; /* 淡蓝灰 */
            color: #1a237e;
            border-radius: 8px;
            font-size: 0.9rem;
            line-height: 1.6;
            border: 1px solid #c5cae9;
        }

        /* 报价显示专用 */
        .quote-display {
            text-align: center;
            font-size: 2rem;
            color: var(--primary-deep);
            font-weight: 800;
            padding: 20px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        @media (max-width: 375px) {
            .navbar a { font-size: 14px; }
            .card { padding: 20px 15px; }
        }
    </style>
</head>
<body>

    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <a href="index.html" class="active">计算器</a>
        <a href="sj.html">水晶展示</a>
        <a href="fs.html">风水摆件</a>
    </nav>

    <div class="container">
        
        <!-- 第一部分：预算反推 -->
        <div class="card">
            <h2>预算反推方案</h2>
            <div class="form-group">
                <label>客户预算总价 (元)</label>
                <input type="number" id="budgetInput" placeholder="请输入客户预算">
            </div>
            <button onclick="calcBudget()">生成方案</button>

            <div id="budgetResult" class="result-box">
                <!-- 结果由JS生成 -->
            </div>
        </div>

        <!-- 第二部分：客户报价 -->
        <div class="card">
            <h2>水晶报价计算</h2>
            <div class="form-group">
                <label>水晶进货价格 (元)</label>
                <input type="number" id="crystalPriceInput" placeholder="请输入进货价">
            </div>
            <button onclick="calcQuote()">计算报价</button>

            <div id="quoteResult" class="result-box" style="text-align: center;">
                <!-- 结果由JS生成 -->
            </div>
        </div>

        <!-- 第三部分：实际利润复盘 -->
        <div class="card">
            <h2>实际利润复盘</h2>
            <div class="form-group">
                <label>客户实际收费 (元)</label>
                <input type="number" id="realCharge" placeholder="客户付的总额">
            </div>
            <div class="form-group">
                <label>水晶实际价格 (元)</label>
                <input type="number" id="realCrystalPrice" placeholder="水晶本身进价">
            </div>
             <div class="form-group">
                <label>东海实收 (元)</label>
                <input type="number" id="donghaiReal" placeholder="付给供货商的总额">
            </div>
            <div class="form-group">
                <label>实际邮费 (元)</label>
                <input type="number" id="realPostage" placeholder="实际快递费">
            </div>
            <button onclick="calcRealProfit()">计算实际分配</button>

            <div id="realResult" class="result-box">
                <!-- 结果由JS生成 -->
            </div>
        </div>

    </div>

    <script>
        // 格式化函数：保留2位小数
        const fmt = (num) => parseFloat(num).toFixed(2);

        // --- 第一部分：预算反推 ---
        function calcBudget() {
            const budget = parseFloat(document.getElementById('budgetInput').value);
            if (!budget) return alert("请输入预算金额");

            // 常量
            const feeDaoGuan = 100;
            const feeConsult = 100;
            const feePostage = 40;
            const feeCheMa = 50;

            // 4. 水晶价格计算 = (预算 - 道观 - 咨询 - 邮费 - 车马费) / 2
            let crystalPrice = (budget - feeDaoGuan - feeConsult - feePostage - feeCheMa) / 2;
            // 限制：水晶价格最高只到预算价格的一半
            if (crystalPrice > budget / 2) {
                crystalPrice = budget / 2; 
            }
            if (crystalPrice < 0) crystalPrice = 0;

            // 5-6. 抽点
            const donghaiPoint = crystalPrice * 0.1;
            const workerPoint = crystalPrice * 0.1;

            // 8. 整体预估利润 = 预算 - 水晶 - 东海 - 打工人 - 邮费 - 车马 - 道观 - 咨询
            const totalProfit = budget - crystalPrice - donghaiPoint - workerPoint - feePostage - feeCheMa - feeDaoGuan - feeConsult;

            // 9-11. 分成
            const workerProfitShare = totalProfit * 0.1;
            const customerSourceProfit = totalProfit * 0.4;
            const platformProfit = totalProfit * 0.4;

            // 12. 平台预估总收益
            const platformTotalIncome = platformProfit + 100;

            // 13. 打工人预估总收入
            const workerTotalIncome = workerPoint + workerProfitShare;

            // 14. 告知客户区间 = (预算 - 道观 - 咨询) / 1.1
            const customerRange = (budget - feeDaoGuan - feeConsult) / 1.1;

            const html = `
                <div class="result-item"><span>道观开光费</span><span>${fmt(feeDaoGuan)}</span></div>
                <div class="result-item"><span>平台咨询费</span><span>${fmt(feeConsult)}</span></div>
                <div class="result-item"><span>预估邮费</span><span>${fmt(feePostage)}</span></div>
                <div class="result-item"><span>车马费</span><span>${fmt(feeCheMa)}</span></div>
                <div class="result-item"><span>东海抽点</span><span>${fmt(donghaiPoint)}</span></div>
                <div class="result-item"><span>打工人抽点</span><span>${fmt(workerPoint)}</span></div>
                <div class="result-item highlight"><span>水晶价格</span><span>${fmt(crystalPrice)}</span></div>
                <div class="result-item"><span>整体预估利润</span><span>${fmt(totalProfit)}</span></div>
                <div class="result-item highlight"><span>客户来源预估利润</span><span>${fmt(customerSourceProfit)}</span></div>
                <div class="result-item"><span>平台预估利润</span><span>${fmt(platformProfit)}</span></div>
                <div class="result-item"><span>平台预估总收益</span><span>${fmt(platformTotalIncome)}</span></div>
                <div class="result-item highlight"><span>打工人预估总收入</span><span>${fmt(workerTotalIncome)}</span></div>
                
                <div class="notice-text">
                    预算除掉100定制费和100的开光费后，会给你找进货价在 <strong>${fmt(customerRange)}</strong> 左右的水晶。东海水晶城供货那边要有10%左右的利润。
                </div>
            `;
            const box = document.getElementById('budgetResult');
            box.innerHTML = html;
            box.style.display = 'block';
        }

        // --- 第二部分：报价计算 ---
        function calcQuote() {
            const price = parseFloat(document.getElementById('crystalPriceInput').value);
            if (!price) return alert("请输入水晶进货价");

            // 公式：水晶价格*2 + 50 + 40 + 200
            const quote = (price * 2) + 50 + 40 + 200;

            const html = `
                <div style="color:#666; margin-bottom:10px;">建议给客户报价：</div>
                <div class="quote-display">¥ ${fmt(quote)}</div>
            `;
            const box = document.getElementById('quoteResult');
            box.innerHTML = html;
            box.style.display = 'block';
        }

        // --- 第三部分：实际利润复盘 ---
        function calcRealProfit() {
            const charge = parseFloat(document.getElementById('realCharge').value);
            const crystalPrice = parseFloat(document.getElementById('realCrystalPrice').value);
            const donghaiReal = parseFloat(document.getElementById('donghaiReal').value);
            const postage = parseFloat(document.getElementById('realPostage').value);

            if (isNaN(charge) || isNaN(crystalPrice) || isNaN(donghaiReal) || isNaN(postage)) {
                return alert("请完整填写所有金额");
            }

            // 常量
            const feeDaoGuan = 100;
            const feeConsult = 100;
            const feeCheMa = 50;

            // 2. 打工人抽点
            const workerPoint = crystalPrice * 0.1;

            // 6. 整体利润 = 客户收费 - 东海实收 - 实际邮费 - 打工人抽点 - 道观开光 - 车马 - 平台咨询
            const totalProfit = charge - donghaiReal - postage - workerPoint - feeDaoGuan - feeCheMa - feeConsult;

            // 7. 打工人利润分成 (20%)
            const workerProfitShare = totalProfit * 0.2;

            // 8. 客户来源利润分成 (40%)
            const customerSourceShare = totalProfit * 0.4;

            // 9. 平台利润分成 (40%)
            const platformProfitShare = totalProfit * 0.4;

            // 10. 打工人总收入
            const workerTotalIncome = workerPoint + workerProfitShare;

            // 11. 打工人每人分成
            const workerPerPerson = workerTotalIncome / 2;

            // 12. 平台利润+客户来源利润
            const platformPlusCustomer = platformProfitShare + customerSourceShare; // 即 totalProfit * 0.8

            // 构建显示 HTML
            const html = `
                <div class="result-item"><span>客户实际收费</span><span>${fmt(charge)}</span></div>
                <div class="result-item"><span>道观开光费</span><span>${fmt(feeDaoGuan)}</span></div>
                <div class="result-item"><span>车马费</span><span>${fmt(feeCheMa)}</span></div>
                <div class="result-item"><span>实际邮费</span><span>${fmt(postage)}</span></div>
                <div class="result-item"><span>水晶实际价格</span><span>${fmt(crystalPrice)}</span></div>
                <div class="result-item"><span>打工人抽点</span><span>${fmt(workerPoint)}</span></div>
                <div class="result-item"><span>打工人利润分成(20%)</span><span>${fmt(workerProfitShare)}</span></div>
                <div class="result-item highlight"><span>客户来源利润分成(40%)</span><span>${fmt(customerSourceShare)}</span></div>
                <div class="result-item"><span>平台咨询费</span><span>${fmt(feeConsult)}</span></div>
                <div class="result-item highlight"><span>平台利润分成(40%)</span><span>${fmt(platformProfitShare)}</span></div>
                <div class="result-item"><span>平台利润+客户来源利润</span><span>${fmt(platformPlusCustomer)}</span></div>
                <div class="result-item"><span>打工人总收入</span><span>${fmt(workerTotalIncome)}</span></div>
                <div class="result-item highlight"><span>打工人每个人分成</span><span>${fmt(workerPerPerson)}</span></div>
            `;
            const box = document.getElementById('realResult');
            box.innerHTML = html;
            box.style.display = 'block';
        }
    </script>
</body>
</html>
